@import '~@payloadcms/ui/scss';
@import './components/Header/index.scss';
@import './components/Toolbar/index.scss';
@import './components/Sidebar/index.scss';
@import './components/Grid/index.scss';

:root {
  --seat-maker-z-base: 1;
  --seat-maker-z-element: 5;
  --seat-maker-z-element-selected: 8;
  --seat-maker-z-element-editing: 12;
  --seat-maker-z-element-dragging: 15;
  --seat-maker-z-toolbar: 25;
  --seat-maker-z-overlay: 35;
}

:root {
  --seat-maker-border-radius: var(--style-radius-s);
  --seat-maker-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
  --seat-maker-shadow-hover: 0 4px 8px rgba(0, 0, 0, 0.12);
  --seat-maker-gap-small: calc(var(--base) * 0.25);
  --seat-maker-gap-medium: calc(var(--base) * 0.5);
  --seat-maker-gap-large: calc(var(--base) * 0.75);
}

@layer payload-default {
  .seat-maker {
    width: 100%;
    background: var(--theme-elevation-0);
    border: 1px solid var(--theme-border-color);
    border-radius: var(--style-radius-m);
    font-family: var(--font-body);
    overflow: hidden;
    position: relative;
    direction: ltr !important;

    * {
      direction: ltr !important;
      text-align: left !important;
    }

    &:focus-within {
      outline: none;
      box-shadow: 0 0 0 2px var(--theme-success-300);
    }

    // Accessibility: High contrast mode support
    @media (prefers-contrast: high) {
      border-width: 2px;

      .seat-maker__element {
        border-width: 3px;
        font-weight: 700;

        &--selected {
          box-shadow: 0 0 0 4px var(--theme-text);
          outline: 2px solid var(--theme-bg);
          outline-offset: 2px;
        }
      }

      .seat-maker__btn {
        border-width: 2px;
        font-weight: 600;
      }
    }

    // Accessibility: Reduced motion support
    @media (prefers-reduced-motion: reduce) {
      *,
      *::before,
      *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
      }
    }

    // Dark mode optimizations
    html[data-theme='dark'] & {
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);

      .seat-maker__element {
        box-shadow: var(--seat-maker-shadow);

        &:hover {
          box-shadow: var(--seat-maker-shadow-hover);
        }

        &--seat {
          &.seat-maker__element--disabled {
            &::after {
              background: var(--theme-error-400);
              box-shadow: 0 0 2px rgba(255, 255, 255, 0.2);
            }
          }
        }

        &--driver {
          background: var(--color-blue-800);
          border-color: var(--color-blue-600);
          color: var(--color-blue-200);

          &:hover {
            background: var(--color-blue-700);
            border-color: var(--color-blue-500);
          }
        }
      }
    }

    @include extra-small-break {
      .seat-maker__grid-container {
        padding: var(--seat-maker-gap-medium);
      }

      .seat-maker__grid {
        gap: 1px;
        padding: var(--seat-maker-gap-medium);
      }

      .seat-maker__element {
        padding: var(--seat-maker-gap-small);

        svg {
          width: calc(var(--base) * 0.625);
          height: calc(var(--base) * 0.625);
        }

        &-label {
          font-size: calc(var(--base) * 0.5);
        }
      }

      .seat-maker__content {
        grid-template-columns: 1fr;
      }
    }

    // Touch device optimizations
    @media (hover: none) and (pointer: coarse) {
      .seat-maker__element {
        padding: calc(var(--base) * 0.5);

        &:hover {
          transform: none;
        }
      }

      .seat-maker__tool {
        padding: var(--base);

        &:hover {
          transform: none;
        }
      }
    }

    // Print styles
    @media print {
      border: 2px solid #000;
      box-shadow: none;

      .seat-maker__toolbar,
      .seat-maker__sidebar {
        display: none;
      }

      .seat-maker__content {
        grid-template-columns: 1fr;
      }

      .seat-maker__element {
        box-shadow: none !important;
        border: 2px solid #000 !important;
        background: white !important;
        color: black !important;

        &--selected {
          background: #f0f0f0 !important;
        }
      }
    }

    // Loading state styles
    &--loading {
      pointer-events: none;
      opacity: 0.7;

      &::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(255, 255, 255, 0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: var(--seat-maker-z-overlay);
      }
    }

    // Error state styles
    &--error {
      border-color: var(--theme-error-500);
      background: var(--theme-error-50);
    }
  }
}
